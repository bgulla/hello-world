kind: pipeline
name: default
steps:
  # - name: test
  #   image: golang:1.10-alpine
  #   commands:
  #   - "go test"
  # - name: build
  #   image: golang:1.10-alpine
  #   commands:
  #     - "go build -o ./myapp"
  - name: publish
    image: plugins/docker
    settings:
      repo: rancherfederal/hello-world
      tags: [ "${DRONE_COMMIT_SHA:0:7}","latest" ]
      username:
        from_secret: docker_username
      password:
        from_secret: docker_password
  - name: slack
    image: plugins/slack
    settings:
      webhook: 
        from_secret: slack_webhook
      channel: cicd
    when:
      status: [ success, failure ]
